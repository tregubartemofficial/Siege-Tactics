# 2.5D Isometric Rendering Guide

**Project:** Siege Tactics  
**Visual Style:** 2.5D Isometric Hex Grid  
**Created:** November 21, 2025

---

## What is 2.5D Isometric?

**2.5D (Pseudo-3D)** combines 2D graphics with 3D perspective:
- **NOT** full 3D rendering (no WebGL, no complex lighting)
- **IS** 2D canvas with perspective transformation
- **Static camera** - Fixed viewing angle, no rotation or movement
- Creates illusion of depth using:
  - Isometric angle (30Â° rotation)
  - Visible side faces on hexes
  - Shadows and gradients
  - Z-order depth sorting

**Visual Result:** Looks like a tabletop strategy game viewed from above at a fixed angle.
**Camera:** Static (no panning, zooming, or rotation - keeps complexity low)

---

## Visual Comparison

### Flat 2D (Original Plan)
```
     ___       ___       ___
    /   \     /   \     /   \
   /     \___/     \___/     \
   \     /   \     /   \     /
    \___/     \___/     \___/
        \     /   \     /
         \___/     \___/
```
- Simple, fast to render
- Looks flat and basic
- Hard to judge positioning

### 2.5D Isometric (New Approach)
```
        ____        ____
       /    \      /    \
      /  T   \____/  T   \
      \      /    \      /
       \____/  S   \____/
       /    \      /    \
      /  S   \____/  S   \
      \      /    \      /
       \____/      \____/
```
(T = Top face, S = Side face visible)

- Professional appearance
- Clear depth perception
- Medieval tabletop aesthetic
- Better unit positioning clarity

---

## Technical Implementation

### Coordinate Transformation

**Step 1: Standard Hex Coordinates**
```typescript
// Cube coordinates: q, r, s (where q + r + s = 0)
const q = 2, r = -1, s = -1;
```

**Step 2: Hex to 2D Pixel**
```typescript
const flatX = hexSize * (3/2 * q);
const flatY = hexSize * (Math.sqrt(3)/2 * q + Math.sqrt(3) * r);
```

**Step 3: Apply Isometric Projection**
```typescript
const ISO_ANGLE = Math.PI / 6; // 30 degrees
const isoX = flatX * Math.cos(ISO_ANGLE) - flatY * Math.sin(ISO_ANGLE);
const isoY = flatX * Math.sin(ISO_ANGLE) + flatY * Math.cos(ISO_ANGLE);
```

### Hex Drawing Process

**1. Sort by Depth (Back to Front)**
```typescript
// Hexes further "back" (lower on screen) drawn first
sortedHexes.sort((a, b) => pixelA.y - pixelB.y);
```

**2. Draw Each Hex in 3 Parts**
```
   a. Draw side faces (depth effect)
   b. Draw top face (main surface)
   c. Draw border (outline)
```

**3. Lighting & Gradients**
```typescript
// Top face: gradient from light to dark
gradient.addColorStop(0, '#8aab5f'); // Light green
gradient.addColorStop(1, '#6a8b3f'); // Dark green
```

---

## Visual Elements

### Hex Tiles

**Top Face:**
- Color: Grass green `#7a9b4f`
- Gradient: Light to dark (top-left to bottom-right)
- Border: Stone gray `#5a5a5a`, 2px

**Side Faces (3 visible sides):**
- Color: Darker green `#5a7a3a`
- Height: 8 pixels
- Creates 3D depth illusion

**Shrink Zone:**
- Top: Dark red `#6a3030`
- Sides: Darker red `#4a2020`

### Units (Story 02)

Units rendered with:
- Slight Y-offset (elevated above hex surface)
- Drop shadow beneath unit
- Isometric-compatible positioning

### Example Colors

```css
/* Normal Hexes */
--hex-top: #7a9b4f;        /* Grass green */
--hex-side: #5a7a3a;       /* Dark grass */
--hex-border: #5a5a5a;     /* Stone gray */

/* Shrink Zone */
--shrink-top: #6a3030;     /* Dark red */
--shrink-side: #4a2020;    /* Darker red */

/* Units */
--player-catapult: #4a7ba7;   /* Blue */
--player-ballista: #6a9b4f;   /* Green */
--player-trebuchet: #8a4a9b;  /* Purple */
--ai-unit: #a74a4a;           /* Red */
```

---

## Camera Strategy

### Static Camera (Fixed View)

**Decision:** Camera is **completely static** - no user controls for movement or rotation.

**Why Static?**
1. âœ… **Simplicity** - No camera math, no viewport calculations
2. âœ… **Performance** - No redraw on camera movement
3. âœ… **Hackathon Scope** - Reduces dev time by 1-2 hours
4. âœ… **Tactical Clarity** - Fixed view is standard for turn-based games
5. âœ… **UI Simplicity** - No zoom/pan controls needed

**Implementation:**
- Camera position is set once in `BattlefieldRenderer` constructor
- `centerX` and `centerY` are constants (canvas center)
- No camera state management needed
- All hexes always visible (15x15 grid fits on screen)

**User Experience:**
- Entire battlefield always visible
- Click directly on hexes (no need to pan around)
- Standard for games like Civilization, XCOM, Into the Breach
- Players expect this in hex-grid tactics games

**Future Enhancement (Post-Hackathon):**
- Could add zoom (optional)
- Could add pan for larger maps (not needed for 15x15)
- Camera controls would be Story 07+

---

## Performance Considerations

### Optimizations Needed

1. **Z-Order Sorting:**
   - Only sort once per render frame
   - Cache sorted order if battlefield static

2. **Drawing Optimization:**
   - Draw all side faces first (batch)
   - Then all top faces
   - Reduces context switches

3. **Canvas State:**
   - Use `ctx.save()` / `ctx.restore()` sparingly
   - Set fill/stroke styles only when changed

### Expected Performance

- **Target:** 60fps on modern hardware
- **Hex Count:** 169 hexes (15x15 grid)
- **Draw Calls:** ~600 per frame (169 hexes Ã— 3 faces + borders)
- **Estimated Time:** 8-10ms per frame (well under 16.67ms budget)

---

## Implementation Order

### Story 01: Battlefield Rendering (3 hours)

**Hour 1: Basic Isometric Setup**
- Coordinate transformation
- Single hex drawing
- Verify isometric angle looks correct

**Hour 2: Full Grid Rendering**
- Z-order sorting
- All hexes drawn
- Side face rendering

**Hour 3: Polish & Styling**
- Gradients and lighting
- Shrink zone differentiation
- Border refinement

### Story 02: Unit Rendering (1.5 hours)

**Units positioned on isometric hexes:**
- Use same `hexToIsometricPixel()` function
- Add Y-offset for elevation
- Draw shadows beneath units

---

## Visual References

### Isometric Angle Visualization
```
        Top View              Isometric View
       
         North                    North
           |                      /
           |                     /
    West --+-- East       West -+
           |                     \
           |                      \
         South                    South
                               (30Â° rotation)
```

### Depth Layering
```
Layer 1 (Back):    Hexes with low Y coordinate
Layer 2 (Middle):  Hexes with mid Y coordinate  
Layer 3 (Front):   Hexes with high Y coordinate
Layer 4 (Top):     Units on hexes
Layer 5 (UI):      Selection highlights, overlays
```

---

## Why This Improves the Game

1. **Professional Appearance** - Looks like a polished indie game, not a prototype
2. **Better Spatial Awareness** - Players understand unit positioning intuitively
3. **Medieval Aesthetic** - Matches the siege weapon theme (tabletop war game feel)
4. **Visual Interest** - Depth and shadows make battlefield more engaging
5. **Hackathon Impact** - Judges will notice the visual quality immediately

---

## Fallback Plan

If isometric rendering proves too complex or slow:

**Quick Simplification:**
1. Remove side faces (just draw top faces)
2. Keep isometric projection (still looks angled)
3. Add drop shadows for depth cue

**Result:** Still better than flat 2D, faster to implement.

---

## Testing Checklist

### Visual Quality
- [ ] Hex grid looks isometric (angled, not flat)
- [ ] No gaps between hexes
- [ ] Side faces visible on correct edges
- [ ] Gradients smooth and attractive
- [ ] Shrink zone clearly differentiated

### Technical Performance
- [ ] 60fps maintained
- [ ] No flickering or tearing
- [ ] Z-order sorting correct (no visual artifacts)
- [ ] Canvas clears properly each frame

### Interaction
- [ ] Click detection works on isometric hexes
- [ ] Units positioned correctly
- [ ] Selection highlighting visible

---

**Ready to implement!** Story 01 now includes complete 2.5D isometric code.

Start whenever you're ready - the visual result will be worth the extra hour! ðŸŽ®
